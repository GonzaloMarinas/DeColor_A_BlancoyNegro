<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Procesar imagen con OpenCV.js</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 20px; }
    .inputoutput { display: inline-block; margin: 10px; }
    canvas, img { border: 1px solid #ccc; max-width: 400px; }
  </style>
</head>

<body>
  <h2>Hola, genera tu imágen en blanco y negro</h2>
  <p id="status">OpenCV.js is loading...</p>

  <div class="inputoutput">
    <img id="imageSrc" alt="No Image" />
    <div class="caption">
      Imagen de entrada:
      <input type="file" id="fileInput" name="file" />
    </div>
  </div>

  <div class="inputoutput">
    <canvas id="canvasOutput"></canvas>
    <div class="caption">Resultado en blanco y negro</div>
  </div>

  <script type="text/javascript">
    
    let imgElement = document.getElementById('imageSrc');
    let inputElement = document.getElementById('fileInput');
    inputElement.addEventListener('change', (e) => {
      imgElement.src = URL.createObjectURL(e.target.files[0]);
    }, false);

    imgElement.onload = function() {
      let src = cv.imread(imgElement);
      let dst = new cv.Mat();

      // aqui voy a convertir a escala de grises

      cv.cvtColor(src, dst, cv.COLOR_RGBA2GRAY);
      cv.imshow('canvasOutput', dst);
      src.delete();
      dst.delete();
    };

    // Inicio del módulo de OpenCV

    var Module = {
      onRuntimeInitialized() {
        document.getElementById('status').innerHTML = 'OpenCV.js is ready.';
      }
    };
  </script>


  <script async src="https://docs.opencv.org/4.x/opencv.js" type="text/javascript"></script>
</body>
</html>
